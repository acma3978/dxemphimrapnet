<?phpdefined('SYSPATH') or die('No direct script access.');class Controller_Frontend_Ajax_Dependencies extends Controller_Frontend_Ajax{    public function before()    {        parent::before();        //$this->_assert_ajax_only();    }    protected function action_tab(){        $type = $this->_input->filter_single('type', Light_Input::STRING);        switch ($type){            case 'ajax-phim-hoat-hinh':                if (!$this->_caching OR !$phim_hoat_hinh = $this->_cache->get('phim_hoat_hinh')){                    $phim_hoat_hinh = $this->_get_film(NULL, 6, 9, FALSE, $this->_objectSel["option"] = array('order' => array('film.last_update_episode' => 'DESC')));                    !$this->_caching OR $this->_cache->set('phim_hoat_hinh', $phim_hoat_hinh);                }                $html = $this->view('home/tab_home')->set('phim_hoat_hinh', $phim_hoat_hinh)->render();                break;            case 'ajax-category-title':                $category_title = $this->_input->filter_single('category_title', Light_Input::STRING);                if (!$phim_related_title = $this->_cache->get('phim_related_title')){                    $phim_related_title = $this->_get_film(0, NULL, '8', NULL, $this->_objectSel["option"] = array(                        'order' => array(                            'film.year' => 'DESC',                            'film.last_update_episode' => 'DESC'                        ) ,                        'conditions' => array(                            'title' => $category_title,                        )                    ));                    !$this->_caching OR $this->_cache->set('phim_related_title', $phim_related_title);                }                $html = $this->view('home/tab_home')->set('phim_related_title', $phim_related_title)->render();                break;            case 'ajax-phim-moi-nhat-xem-nhieu':                if (!$this->_caching OR !$phim_moi_nhat_xem_nhieu = $this->_cache->get('phim_moi_nhat_xem_nhieu'))                {                    $i = 1;                    $count_phim_moi_nhat_xem_nhieu = $this->_get_film(NULL, NULL, 10, FALSE, $this->_objectSel['option'] = array(                        'order' => array(                            'film.views_day' => 'DESC',                            'film.last_update_episode' => 'DESC',                            'film.year' => 'DESC'                        )                    ));                    foreach($count_phim_moi_nhat_xem_nhieu as $k => $item)                    {                        if ($i == 1)                        {                            $phim_moi_nhat_xem_nhieu['top'][$i] = $item;                        }                        elseif ($i > 1)                        {                            $phim_moi_nhat_xem_nhieu['last'][$i] = $item;                        }                        $i++;                    }                    !$this->_caching OR $this->_cache->set('phim_moi_nhat_xem_nhieu', $phim_moi_nhat_xem_nhieu);                }                $html = $this->view('home/tab_home')->set('phim_moi_nhat_xem_nhieu', $phim_moi_nhat_xem_nhieu)->render();                break;        }        echo $html;    }}